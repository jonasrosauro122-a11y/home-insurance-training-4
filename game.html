<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LAVA Classroom ‚Äî Flappy Quiz</title>
  <style>
    :root {
      --accent: #ff1f1f;
      --accent-glow: #ff4b4b;
      --bg1: #000;
      --bg2: #2b0000;
      --card: #0f0f0f;
      --shadow: 0 0 25px rgba(255, 0, 0, 0.4);
    }

    * { box-sizing: border-box; }

    html, body {
      height: 100%;
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: radial-gradient(circle at top left, var(--bg1), var(--bg2));
      color: #fff;
      overflow: hidden;
    }

    /* Header */
    .site-header {
      position: fixed;
      left: 0; right: 0; top: 0;
      z-index: 50;
      background: rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(6px);
    }
    .header-inner.container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: #fff;
      font-weight: 700;
    }
    .brand img { height: 36px; }
    .main-nav ul {
      display: flex;
      gap: 12px;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .main-nav a {
      color: #fff;
      text-decoration: none;
      padding: 6px 10px;
      border-radius: 6px;
      transition: all 0.2s;
    }
    .main-nav a.active, .main-nav a:hover {
      background: var(--accent);
      box-shadow: 0 0 10px var(--accent-glow);
    }

    /* Game Canvas */
    #gameArea {
      position: fixed;
      left: 0; right: 0; top: 64px; bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    canvas {
      border-radius: 10px;
      border: 3px solid var(--accent);
      box-shadow: var(--shadow);
      background: #70c8ff;
    }

    /* HUD */
    .hud {
      position: absolute;
      top: 78px;
      width: 100%;
      text-align: center;
      pointer-events: none;
      z-index: 40;
    }
    .hud .score {
      font-size: 28px;
      font-weight: 800;
    }
    .hud .high {
      font-size: 12px;
      color: rgba(255,255,255,0.9);
    }

    /* Start Panel */
    #startPanel {
      position: absolute;
      top: 38%;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      z-index: 45;
      animation: fadeIn 1s ease-out;
    }
    #startPanel input {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.1);
      width: 220px;
      margin-bottom: 8px;
      text-align: center;
    }
    .btn {
      padding: 10px 16px;
      border-radius: 10px;
      border: none;
      background: var(--accent);
      color: #fff;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px var(--accent-glow);
    }
    .btn.ghost {
      background: transparent;
      border: 1px solid rgba(255,255,255,0.2);
    }

    #giveUp {
      position: absolute;
      top: 76px;
      right: 20px;
      z-index: 45;
    }

    /* Quiz */
    #quizBox {
      display: none;
      position: absolute;
      left: 50%;
      top: 20%;
      transform: translateX(-50%);
      width: 88%;
      max-width: 520px;
      background: rgba(15,15,15,0.9);
      border: 2px solid var(--accent);
      padding: 16px;
      border-radius: 12px;
      z-index: 60;
      text-align: left;
      animation: fadeInUp 0.4s ease-out;
    }
    #quizBox h3 {
      color: #fff;
      margin: 0 0 10px;
      text-align: center;
    }
    .choices {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .choiceBtn {
      background: #222;
      color: #fff;
      border-radius: 8px;
      padding: 10px;
      border: none;
      cursor: pointer;
      text-align: center;
      transition: 0.2s;
    }
    .choiceBtn:hover {
      background: var(--accent);
      transform: scale(1.05);
    }

    /* Modal */
    #modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      z-index: 80;
      align-items: center;
      justify-content: center;
    }
    #modal .card {
      background: #111;
      color: #fff;
      padding: 20px;
      border-radius: 12px;
      width: 92%;
      max-width: 520px;
      border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 0 25px rgba(255,0,0,0.3);
      animation: slideUp 0.5s ease-out;
    }
    #modal h2 {
      color: var(--accent);
      margin: 0 0 8px;
    }
    ol.leader {
      padding-left: 18px;
      margin: 8px 0 0;
      max-height: 220px;
      overflow-y: auto;
    }
    ol.leader li {
      background: #181818;
      padding: 8px;
      border-radius: 8px;
      margin: 6px 0;
      transition: transform 0.3s;
    }
    ol.leader li:hover { transform: scale(1.02); background: #222; }

    #countText {
      position: absolute;
      top: 45%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 100px;
      font-weight: 900;
      color: var(--accent);
      pointer-events: none;
      z-index: 70;
      display: none;
      animation: popText 0.8s ease-out infinite alternate;
    }

    /* Sidebar Left - Leaderboard */
    #playerSidebar {
      position: absolute;
      left: 20px;
      top: 100px;
      background: rgba(0, 0, 0, 0.55);
      border: 1px solid var(--accent);
      padding: 12px;
      border-radius: 10px;
      z-index: 50;
      width: 200px;
      max-height: 440px;
      overflow-y: auto;
      box-shadow: var(--shadow);
      animation: slideInLeft 0.6s ease-out;
    }
    #playerSidebar h4 {
      margin: 0 0 8px;
      font-size: 16px;
      text-align: center;
      color: var(--accent);
      text-shadow: 0 0 10px var(--accent);
    }
    #playerSidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #playerSidebar li {
      padding: 6px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.2s;
    }
    #playerSidebar li:hover { color: var(--accent); transform: scale(1.05); }

    /* Right Scorecard */
    #scoreCard {
      position: absolute;
      right: 20px;
      top: 100px;
      background: rgba(0,0,0,0.55);
      border: 1px solid var(--accent);
      padding: 12px;
      border-radius: 10px;
      width: 200px;
      max-height: 440px;
      overflow-y: auto;
      z-index: 50;
      box-shadow: var(--shadow);
      animation: slideInRight 0.6s ease-out;
    }
    #scoreCard h4 {
      margin: 0 0 8px;
      font-size: 16px;
      text-align: center;
      color: var(--accent);
      text-shadow: 0 0 10px var(--accent);
    }
    #scoreCard ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #scoreCard li {
      padding: 6px;
      background: #111;
      border-radius: 8px;
      margin-bottom: 6px;
      transition: all 0.2s ease;
      animation: fadeInUp 0.4s ease;
    }
    #scoreCard li.highlight {
      background: var(--accent);
      color: #fff;
      transform: scale(1.05);
      box-shadow: 0 0 15px var(--accent-glow);
    }

    /* Fireworks & Messages */
    #fireworksMsg {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 48px;
      font-weight: 900;
      color: #ffdb4d;
      text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000;
      display: none;
      animation: popText 2s ease-out forwards;
      z-index: 90;
    }

    @keyframes popText {
      0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
      40% { transform: translate(-50%, -50%) scale(1.3); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }
    @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
    @keyframes fadeInUp { from {opacity: 0; transform: translateY(10px);} to {opacity: 1; transform: translateY(0);} }
    @keyframes slideInLeft { from {opacity: 0; transform: translateX(-30px);} to {opacity: 1; transform: translateX(0);} }
    @keyframes slideInRight { from {opacity: 0; transform: translateX(30px);} to {opacity: 1; transform: translateX(0);} }
    @keyframes slideUp { from {transform: translateY(30px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="header-inner container">
      <a class="brand" href="index.html"><img src="images/logo.png" alt="LAVA">LAVA Classroom</a>
      <nav class="main-nav">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">Trainers</a></li>
          <li><a href="courses.html">Courses</a></li>
          <li><a href="assignments.html">LAVA University</a></li>
          <li><a href="game.html" class="active">Games</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section id="gameArea">
    <canvas id="canvas" width="420" height="630"></canvas>

    <!-- LEFT: Player Leaderboard -->
    <div id="playerSidebar">
      <h4>üèÜ Pipe Leaderboard</h4>
      <ul id="sideList"></ul>
    </div>

    <!-- RIGHT: Scorecard -->
    <div id="scoreCard">
      <h4>üéØ Quiz Scorecard</h4>
      <ul id="scoreList"></ul>
    </div>

    <div id="fireworksMsg">Awesome!</div>

    <div class="hud">
      <div class="score" id="scoreLabel">0</div>
      <div class="high" id="highLabel">High: 0</div>
    </div>

    <div id="startPanel">
      <input id="playerName" placeholder="Enter your name" />
      <div><button id="startBtn" class="btn">Start</button></div>
    </div>

    <button id="giveUp" class="btn ghost">Give Up</button>

    <div id="quizBox">
      <h3 id="quizQ">Question</h3>
      <div class="choices" id="choices"></div>
    </div>

    <div id="modal">
      <div class="card">
        <h2>üèÜ LAVA Leaderboard</h2>
        <p id="finalText">Final score: 0</p>
        <ol class="leader" id="leaderList"></ol>
        <div style="margin-top:12px;text-align:center">
          <button id="modalClose" class="btn">Close</button>
          <button id="goDashboard" class="btn ghost">Go to Dashboard</button>
        </div>
      </div>
    </div>

    <div id="countText">3</div>
  </section>

  <script>
    (() => {
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const scoreLabel = document.getElementById("scoreLabel");
      const highLabel = document.getElementById("highLabel");
      const startPanel = document.getElementById("startPanel");
      const playerNameInput = document.getElementById("playerName");
      const giveUpBtn = document.getElementById("giveUp");
      const quizBox = document.getElementById("quizBox");
      const quizQ = document.getElementById("quizQ");
      const choicesWrap = document.getElementById("choices");
      const modal = document.getElementById("modal");
      const leaderList = document.getElementById("leaderList");
      const finalText = document.getElementById("finalText");
      const modalClose = document.getElementById("modalClose");
      const goDashboard = document.getElementById("goDashboard");
      const countText = document.getElementById("countText");
      const sideList = document.getElementById("sideList");
      const scoreList = document.getElementById("scoreList");
      const fireworksMsg = document.getElementById("fireworksMsg");

      const W = canvas.width, H = canvas.height;
      const birdImg = new Image(); birdImg.src = "images/bird.png";
      const pipeImg = new Image(); pipeImg.src = "images/pipe.png";
      const bgImg = new Image(); bgImg.src = "images/bg.png";

      let bird, pipes, frame, score, high, running, questionActive, gameOver, playerName, questionIndex = 0;
      const gravity = 0.45, jump = -8, pipeSpeed = 2, pipeGap = 160, pipeW = 52;

      const questions = [
        { q:"An organization of insurers through which risks are pooled.", a:"insurance pool" },
        { q:"Anyone can be an agent. True or False.", a:"false" },
        { q:"A financial agreement to transfer risk for premiums.", a:"insurance" },
        { q:"Professional who evaluates risk.", a:"underwriter" },
        { q:"Amount you pay out of pocket before insurance starts.", a:"deductible" },
        { q:"Person or business protected under a policy.", a:"insured" },
        { q:"Company that provides insurance coverage.", a:"insurer" },
        { q:"Change or addition made to existing policy.", a:"endorsement" },
        { q:"Document outlining terms, coverages, exclusions.", a:"policy" },
        { q:"Meaning of AMS.", a:"agency management system" },
        { q:"Form used to request coverage from carriers.", a:"acord form" },
        { q:"Type of insurance that covers business property.", a:"commercial property" },
        { q:"Insurance protecting against data breaches.", a:"cyber liability" },
        { q:"Covers legal liability for injuries or damages.", a:"general liability" },
        { q:"A car used for business purposes needs what insurance?", a:"commercial auto" },
        { q:"Extra coverage that extends policy limits.", a:"umbrella" },
        { q:"Part of homeowners policy covering dwelling.", a:"coverage a" },
        { q:"Part of homeowners policy covering personal property.", a:"coverage c" },
        { q:"Who represents the insured in placing coverage?", a:"agent" },
        { q:"Who issues an insurance policy?", a:"carrier" }
      ];

      function loadScores() {
        try { return JSON.parse(localStorage.getItem("lava_scores") || "[]"); } catch { return []; }
      }
      function saveScores(arr) {
        local
