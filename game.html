<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LAVA Flappy Insurance Quiz</title>
<style>
  * { box-sizing: border-box; }
  body {
    font-family: 'Poppins', sans-serif;
    text-align: center;
    background: linear-gradient(135deg, #000000, #480000);
    color: white;
    overflow: hidden;
  }

  h1 {
    margin-top: 10px;
    color: #ff5555;
  }

  canvas {
    background: rgba(255, 255, 255, 0.08);
    display: block;
    margin: 10px auto;
    border: 2px solid #ff5555;
    border-radius: 10px;
  }

  #gameContainer {
    position: relative;
    display: inline-block;
  }

  #questionBox {
    display: none;
    background: rgba(0,0,0,0.9);
    border: 2px solid #ff5555;
    border-radius: 12px;
    padding: 20px;
    position: absolute;
    top: 20%;
    left: 50%;
    transform: translate(-50%);
    width: 80%;
  }

  #questionBox h3 {
    margin-bottom: 10px;
  }

  #questionBox input {
    padding: 8px;
    border: none;
    border-radius: 6px;
    width: 70%;
    margin-bottom: 10px;
  }

  #questionBox button {
    background: #ff5555;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
  }

  #startBox {
    margin-top: 20px;
  }

  #leaderboard {
    margin-top: 20px;
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 10px;
  }

  #musicControl {
    position: fixed;
    top: 15px;
    right: 20px;
    background: #ff5555;
    border: none;
    padding: 8px 12px;
    border-radius: 10px;
    color: white;
    cursor: pointer;
    font-weight: bold;
  }
</style>
</head>
<body>
  <h1>üèÜ LAVA Flappy Insurance Quiz üïπÔ∏è</h1>

  <button id="musicControl">üîä Music On</button>

  <div id="startBox">
    <input type="text" id="playerName" placeholder="Enter your name" />
    <button id="startGameBtn">Start Game</button>
  </div>

  <div id="gameContainer">
    <canvas id="gameCanvas" width="480" height="320"></canvas>

    <div id="questionBox">
      <h3 id="questionText"></h3>
      <input type="text" id="answerInput" placeholder="Type your answer..." />
      <button id="submitAnswer">Submit</button>
    </div>
  </div>

  <div id="scoreDisplay">Score: <span id="score">0</span></div>

  <div id="leaderboard">
    <h3>üèÖ Leaderboard (Top 5)</h3>
    <ul id="leaderList"></ul>
  </div>

  <audio id="bgMusic" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/10/09/audio_65e0d2f6cb.mp3?filename=arcade-funk-124689.mp3" type="audio/mpeg">
  </audio>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const questionBox = document.getElementById("questionBox");
const questionText = document.getElementById("questionText");
const answerInput = document.getElementById("answerInput");
const submitAnswer = document.getElementById("submitAnswer");
const startGameBtn = document.getElementById("startGameBtn");
const playerNameInput = document.getElementById("playerName");
const scoreDisplay = document.getElementById("score");
const leaderList = document.getElementById("leaderList");
const bgMusic = document.getElementById("bgMusic");
const musicControl = document.getElementById("musicControl");

let musicPlaying = false;
musicControl.addEventListener("click", () => {
  if (!musicPlaying) {
    bgMusic.play();
    musicPlaying = true;
    musicControl.textContent = "üîà Music Off";
  } else {
    bgMusic.pause();
    musicPlaying = false;
    musicControl.textContent = "üîä Music On";
  }
});

let playerName = "";
let birdY = 150;
let birdV = 0;
let gravity = 0.5;
let flap = -7;
let pipes = [];
let gameActive = false;
let score = 0;
let questionActive = false;

const questions = [
{q:"An organization of insurers through which risks are pooled.", a:"insurance pool"},
{q:"Anyone can be an agent. True or False.", a:"false"},
{q:"A financial agreement to transfer risk for premiums.", a:"insurance"},
{q:"Total cost or price of the policy.", a:"premium"},
{q:"Professional who evaluates risk.", a:"underwriter"},
{q:"Works for ONE insurance company only. They are ____.", a:"captive agent"},
{q:"Represents the client, not the insurance company.", a:"broker"},
{q:"What is ACV?", a:"actual cash value"},
{q:"Covers losses and damages to private properties.", a:"personal insurance"},
{q:"Can give insurance advice and bind policies.", a:"insurance agent"},
{q:"Amount you pay out of pocket before insurance starts.", a:"deductible"},
{q:"Regular payment to keep your policy active.", a:"premium"},
{q:"Person who investigates your claim.", a:"claims adjuster"},
{q:"Maximum amount insurer will pay for covered loss.", a:"policy limit"},
{q:"A request you make to cover loss or damage.", a:"claim"},
{q:"Protection that pays for damage you cause to others.", a:"liability coverage"},
{q:"Coverage for non-collision damages (fire, theft).", a:"comprehensive coverage"},
{q:"Process of continuing your insurance policy.", a:"policy renewal"},
{q:"Coverage that pays for damage to your own car when you hit another object.", a:"collision coverage"},
{q:"Proof of your insurance coverage document.", a:"certificate of insurance"},
{q:"Person or business protected under a policy.", a:"insured"},
{q:"Company that provides insurance coverage.", a:"insurer"},
{q:"Change or addition made to existing policy.", a:"endorsement"},
{q:"Document outlining terms, coverages, exclusions.", a:"policy"},
{q:"Meaning of AMS.", a:"agency management system"}
];

function drawBird(){
  ctx.beginPath();
  ctx.arc(80, birdY, 10, 0, Math.PI * 2);
  ctx.fillStyle = "#ff5555";
  ctx.fill();
}

function drawPipes(){
  ctx.fillStyle = "#ffffff55";
  pipes.forEach(p => {
    ctx.fillRect(p.x, 0, 40, p.top);
    ctx.fillRect(p.x, p.bottom, 40, canvas.height - p.bottom);
  });
}

function updateGame(){
  if(!gameActive || questionActive) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBird();
  drawPipes();

  birdV += gravity;
  birdY += birdV;

  if(birdY > canvas.height-10) hitObstacle();

  pipes.forEach(p => {
    p.x -= 2;
    if(p.x + 40 < 0){
      pipes.shift();
      score++;
      scoreDisplay.textContent = score;
    }

    if(80 > p.x && 80 < p.x + 40 && (birdY < p.top || birdY > p.bottom)){
      hitObstacle();
    }
  });

  if(pipes.length < 3){
    let top = Math.random()*150 + 20;
    let gap = 100;
    pipes.push({x:canvas.width, top:top, bottom:top+gap});
  }

  requestAnimationFrame(updateGame);
}

function hitObstacle(){
  questionActive = true;
  gameActive = false;
  const randomQ = questions[Math.floor(Math.random()*questions.length)];
  questionBox.style.display = "block";
  questionText.textContent = randomQ.q;
  answerInput.value = "";
  submitAnswer.onclick = () => {
    const ans = answerInput.value.trim().toLowerCase();
    if(ans === randomQ.a.toLowerCase()){
      questionBox.style.display = "none";
      questionActive = false;
      gameActive = true;
      birdV = -5;
      updateGame();
    } else {
      questionBox.innerHTML = `<h3>‚ùå Wrong Answer! Game Over!</h3><p>Correct: <b>${randomQ.a}</b></p>`;
      setTimeout(endGame, 2000);
    }
  };
}

function startGame(){
  if(!playerNameInput.value.trim()){
    alert("Please enter your name first!");
    return;
  }
  playerName = playerNameInput.value.trim();
  document.getElementById("startBox").style.display = "none";
  resetGame();
}

function resetGame(){
  score = 0;
  scoreDisplay.textContent = score;
  birdY = 150;
  birdV = 0;
  pipes = [];
  gameActive = true;
  updateGame();
}

function endGame(){
  gameActive = false;
  saveScore();
  loadLeaderboard();
  document.getElementById("startBox").style.display = "block";
}

function saveScore(){
  const leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");
  leaderboard.push({name:playerName, score:score});
  leaderboard.sort((a,b)=>b.score-a.score);
  const top5 = leaderboard.slice(0,5);
  localStorage.setItem("leaderboard", JSON.stringify(top5));
}

function loadLeaderboard(){
  const leaderboard = JSON.parse(localStorage.getItem("leaderboard") || "[]");
  leaderList.innerHTML = "";
  leaderboard.forEach((p,i)=>{
    const li = document.createElement("li");
    li.textContent = `${i+1}. ${p.name} ‚Äî ${p.score}`;
    leaderList.appendChild(li);
  });
}

document.addEventListener("keydown", e=>{
  if(e.code === "Space" && gameActive && !questionActive){
    birdV = flap;
  }
});

canvas.addEventListener("click", ()=>{
  if(gameActive && !questionActive) birdV = flap;
});

startGameBtn.onclick = startGame;
loadLeaderboard();
</script>
</body>
</html>
